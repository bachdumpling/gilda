{% comment %}
  This section is used in the product template to render product page with
  media, content, and add-to-cart form.

  https://shopify.dev/docs/storefronts/themes/architecture/templates/product
{% endcomment %}

<div class="flex min-h-screen">
  <!-- Left side: Product Images (2/3 width, scrollable) -->
  <div class="w-2/3 overflow-y-auto max-h-screen">
    <div class="product-images space-y-4 p-6">
      {% for image in product.images %}
        <div class="w-full">
          {% render 'image'
            ,  class: 'product-image w-full h-auto'
            ,  image: image
            , width: 1200 %}
        </div>
      {% endfor %}
    </div>
  </div>

  <!-- Right side: Product Info & Form (1/3 width, fixed) -->
  <div class="w-1/3 bg-white border-l border-gray-200 sticky top-0 h-screen overflow-y-auto">
    <div class="p-6 space-y-6">
      <!-- Product Info -->
      <div class="product-info">
        <h1 class="text-2xl font-bold mb-4">{{ product.title }}</h1>
        <p class="text-xl font-semibold mb-4">{{ product.price | money }}</p>
        {% if product.description != blank %}
          <div class="prose prose-sm mb-6">
            {{ product.description }}
          </div>
        {% endif %}
      </div>

      <!-- Product Form -->
      <div class="product-form">
        {% form 'product'
          , product %}
          {% assign current_variant = product.selected_or_first_available_variant %}

          {% if product.variants.size > 1 %}
            <div class="mb-4">
              <label for="variant-select" class="block text-sm font-medium mb-2">
                Variant
              </label>
              <select
                name="id"
                id="variant-select"
                class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-black focus:border-transparent">
                {% for variant in product.variants %}
                  <option
                    value="{{ variant.id }}"
                    {% if variant == current_variant %}
                    selected="selected"
                    {% endif %}
                    {% unless variant.available %}
                    disabled{% endunless %}>
                    {{ variant.title }} - {{ variant.price | money }}
                    {% unless variant.available %}
                      (Sold out){% endunless %}
                  </option>
                {% endfor %}
              </select>
            </div>
          {% else %}
            <input
              type="hidden"
              name="id"
              value="{{ current_variant.id }}">
          {% endif %}

          <div class="mb-6">
            <label for="quantity" class="block text-sm font-medium mb-2">
              Quantity
            </label>
            <input
              type="number"
              name="quantity"
              id="quantity"
              min="1"
              value="1"
              class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-black focus:border-transparent">
          </div>

          <div class="space-y-3">
            <button
              type="submit"
              class="w-full bg-black text-white py-3 px-6 rounded-md hover:bg-gray-800 transition-colors font-medium"
              {% unless current_variant.available %}
              disabled{% endunless %}>
              {% if current_variant.available %}
                Add to cart
              {% else %}
                Sold out
              {% endif %}
            </button>

            {{ form | payment_button }}
          </div>
        {% endform %}
      </div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "t:general.product",
    "settings": [],
    "disabled_on": {
      "groups": ["header", "footer"]
    }
  }
{% endschema %}